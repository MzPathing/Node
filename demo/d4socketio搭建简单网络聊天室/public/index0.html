<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>第一个websocket</title>
	<script>
		var last;
		window.onload=function (){
			var h1=document.getElementsByTagName('h1')[0];
			var h3=document.getElementsByTagName('h3')[0];
			h3.innerText=new Date().getSeconds();
			h1.onclick=function(){
				var ws=new WebSocket('ws://127.0.0.1:3000/')
				ws.onopen=function (){
					ping()
				}
				ws.onmessage=function (ev){
					console.log('got:'+ev.data);
					document.getElementById('latency').innerHTML=new Date-last
				}
				function ping(){
					last= +new Date;
					ws.send('zai')
				}
			}

		}
	</script>
</head>
<body>
	<h1>websocket Echo</h1>
	<h3>websocket Echo</h3>
	<h2>Latency:<span id="latency"></span></h2>
</body>
</html>